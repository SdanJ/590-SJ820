### HW6.0
### ANLY 590 Section 2
### Shengdan Jin

### HW6.1.py

###########################
##### Training Process ####
###########################

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_96 (Dense)             (None, 784)               615440    
_________________________________________________________________
dense_97 (Dense)             (None, 90)                70650     
_________________________________________________________________
dense_98 (Dense)             (None, 784)               71344     
=================================================================
Total params: 757,434
Trainable params: 757,434
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
48/48 [==============================] - 2s 24ms/step - loss: 0.0901 - acc: 0.0079 - val_loss: 0.0603 - val_acc: 0.0103
Epoch 2/10
48/48 [==============================] - 1s 20ms/step - loss: 0.0497 - acc: 0.0117 - val_loss: 0.0377 - val_acc: 0.0137
Epoch 3/10
48/48 [==============================] - 1s 20ms/step - loss: 0.0360 - acc: 0.0123 - val_loss: 0.0304 - val_acc: 0.0143
Epoch 4/10
48/48 [==============================] - 1s 20ms/step - loss: 0.0274 - acc: 0.0117 - val_loss: 0.0234 - val_acc: 0.0122
Epoch 5/10
48/48 [==============================] - 1s 20ms/step - loss: 0.0234 - acc: 0.0116 - val_loss: 0.0214 - val_acc: 0.0108
Epoch 6/10
48/48 [==============================] - 1s 20ms/step - loss: 0.0197 - acc: 0.0123 - val_loss: 0.0166 - val_acc: 0.0119
Epoch 7/10
48/48 [==============================] - 1s 20ms/step - loss: 0.0180 - acc: 0.0133 - val_loss: 0.0139 - val_acc: 0.0120
Epoch 8/10
48/48 [==============================] - 1s 20ms/step - loss: 0.0157 - acc: 0.0134 - val_loss: 0.0140 - val_acc: 0.0140
Epoch 9/10
48/48 [==============================] - 1s 20ms/step - loss: 0.0144 - acc: 0.0139 - val_loss: 0.0128 - val_acc: 0.0150
Epoch 10/10
48/48 [==============================] - 1s 20ms/step - loss: 0.0136 - acc: 0.0130 - val_loss: 0.0117 - val_acc: 0.0132


#####################################
### Test Accuracy after Training ####
#####################################
110/110 [==============================] - 1s 5ms/step - loss: 28.0390 - acc: 0.0000e+00
test_acc: 0.0


#################################################
### Fraction of times Anomalies are Detected ####
#################################################

1/1 [==============================] - 0s 20ms/step - loss: 28.0096 - acc: 0.0000e+00
 fraction of times anomalies are detected 0.0






####---------------------------------------------------------------------------------------------####
####---------------------------------------------------------------------------------------------####


### HW6.2.py

###########################
##### Training Process ####
###########################

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_36 (Conv2D)           (None, 26, 26, 32)        320       
_________________________________________________________________
dense_20 (Dense)             (None, 26, 26, 90)        2970      
_________________________________________________________________
max_pooling2d_20 (MaxPooling (None, 13, 13, 90)        0         
_________________________________________________________________
conv2d_37 (Conv2D)           (None, 11, 11, 64)        51904     
_________________________________________________________________
max_pooling2d_21 (MaxPooling (None, 5, 5, 64)          0         
_________________________________________________________________
conv2d_38 (Conv2D)           (None, 3, 3, 64)          36928     
_________________________________________________________________
flatten_10 (Flatten)         (None, 576)               0         
_________________________________________________________________
dense_21 (Dense)             (None, 64)                36928     
_________________________________________________________________
dense_22 (Dense)             (None, 10)                650       
=================================================================
Total params: 129,700
Trainable params: 129,700
Non-trainable params: 0
_________________________________________________________________
Model: "sequential_17"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_36 (Conv2D)           (None, 26, 26, 32)        320       
_________________________________________________________________
dense_20 (Dense)             (None, 26, 26, 90)        2970      
_________________________________________________________________
max_pooling2d_20 (MaxPooling (None, 13, 13, 90)        0         
_________________________________________________________________
conv2d_37 (Conv2D)           (None, 11, 11, 64)        51904     
_________________________________________________________________
max_pooling2d_21 (MaxPooling (None, 5, 5, 64)          0         
_________________________________________________________________
conv2d_38 (Conv2D)           (None, 3, 3, 64)          36928     
_________________________________________________________________
flatten_10 (Flatten)         (None, 576)               0         
_________________________________________________________________
dense_21 (Dense)             (None, 64)                36928     
_________________________________________________________________
dense_22 (Dense)             (None, 10)                650       
=================================================================
Total params: 129,700
Trainable params: 129,700
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
48/48 [==============================] - 30s 616ms/step - loss: 7.5488 - acc: 0.1463 - val_loss: 3.3945 - val_acc: 0.1157
Epoch 2/10
48/48 [==============================] - 33s 679ms/step - loss: 3.6104 - acc: 0.0975 - val_loss: 2.8058 - val_acc: 0.0989
Epoch 3/10
48/48 [==============================] - 31s 653ms/step - loss: 2.7534 - acc: 0.0991 - val_loss: 2.6289 - val_acc: 0.1053
Epoch 4/10
48/48 [==============================] - 30s 631ms/step - loss: 2.3784 - acc: 0.1031 - val_loss: 1.9855 - val_acc: 0.0955
Epoch 5/10
48/48 [==============================] - 30s 632ms/step - loss: 2.1532 - acc: 0.0994 - val_loss: 1.8183 - val_acc: 0.0688
Epoch 6/10
48/48 [==============================] - 30s 630ms/step - loss: 1.9612 - acc: 0.0955 - val_loss: 1.4794 - val_acc: 0.0874
Epoch 7/10
48/48 [==============================] - 30s 630ms/step - loss: 1.8473 - acc: 0.0963 - val_loss: 1.6197 - val_acc: 0.1088
Epoch 8/10
48/48 [==============================] - 30s 634ms/step - loss: 1.7407 - acc: 0.0968 - val_loss: 1.6013 - val_acc: 0.0986
Epoch 9/10
48/48 [==============================] - 30s 630ms/step - loss: 1.6719 - acc: 0.0997 - val_loss: 1.4459 - val_acc: 0.1147
Epoch 10/10
48/48 [==============================] - 30s 631ms/step - loss: 1.5874 - acc: 0.0954 - val_loss: 1.5736 - val_acc: 0.0948


#####################################
### Test Accuracy after Training ####
#####################################

1/1 [==============================] - 161s 161s/step - loss: 1.5639 - acc: 0.0969
test_acc: 0.09688333421945572


#################################################
### Fraction of times Anomalies are Detected ####
#################################################

1/1 [==============================] - 0s 284ms/step - loss: 22.2449 - acc: 0.0982
 fraction of times anomalies are detected 0.0981818214058876






####---------------------------------------------------------------------------------------------####
####---------------------------------------------------------------------------------------------####


### HW6.3.py

###########################
##### Training Process ####
###########################

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_3 (Conv2D)            (None, 30, 30, 32)        896       
_________________________________________________________________
dense_3 (Dense)              (None, 30, 30, 90)        2970      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 15, 15, 90)        0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 13, 13, 64)        51904     
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 6, 6, 64)          0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 4, 4, 64)          36928     
_________________________________________________________________
flatten_1 (Flatten)          (None, 1024)              0         
_________________________________________________________________
dense_4 (Dense)              (None, 64)                65600     
_________________________________________________________________
dense_5 (Dense)              (None, 10)                650       
=================================================================
Total params: 158,948
Trainable params: 158,948
Non-trainable params: 0
_________________________________________________________________
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_3 (Conv2D)            (None, 30, 30, 32)        896       
_________________________________________________________________
dense_3 (Dense)              (None, 30, 30, 90)        2970      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 15, 15, 90)        0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 13, 13, 64)        51904     
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 6, 6, 64)          0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 4, 4, 64)          36928     
_________________________________________________________________
flatten_1 (Flatten)          (None, 1024)              0         
_________________________________________________________________
dense_4 (Dense)              (None, 64)                65600     
_________________________________________________________________
dense_5 (Dense)              (None, 10)                650       
=================================================================
Total params: 158,948
Trainable params: 158,948
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
40/40 [==============================] - 36s 886ms/step - loss: 13.7942 - acc: 0.1002 - val_loss: 10.0396 - val_acc: 0.0876
Epoch 2/10
40/40 [==============================] - 38s 946ms/step - loss: 10.0480 - acc: 0.1023 - val_loss: 13.6584 - val_acc: 0.1014
Epoch 3/10
40/40 [==============================] - 38s 963ms/step - loss: 9.0637 - acc: 0.1027 - val_loss: 7.8120 - val_acc: 0.1121
Epoch 4/10
40/40 [==============================] - 37s 917ms/step - loss: 8.7863 - acc: 0.1011 - val_loss: 7.6840 - val_acc: 0.0905
Epoch 5/10
40/40 [==============================] - 36s 907ms/step - loss: 7.8744 - acc: 0.1002 - val_loss: 8.1994 - val_acc: 0.1012
Epoch 6/10
40/40 [==============================] - 36s 909ms/step - loss: 7.6340 - acc: 0.0985 - val_loss: 6.9621 - val_acc: 0.0854
Epoch 7/10
40/40 [==============================] - 36s 913ms/step - loss: 7.4269 - acc: 0.0955 - val_loss: 7.0166 - val_acc: 0.0960
Epoch 8/10
40/40 [==============================] - 37s 920ms/step - loss: 7.1413 - acc: 0.0989 - val_loss: 7.1744 - val_acc: 0.1009
Epoch 9/10
40/40 [==============================] - 37s 918ms/step - loss: 7.0045 - acc: 0.0971 - val_loss: 7.3998 - val_acc: 0.0943
Epoch 10/10
40/40 [==============================] - 37s 916ms/step - loss: 6.6855 - acc: 0.0934 - val_loss: 6.7863 - val_acc: 0.0916


#####################################
### Test Accuracy after Training ####
#####################################

1/1 [==============================] - 148s 148s/step - loss: 6.6255 - acc: 0.0943
test_acc: 0.09425999969244003


#################################################
### Fraction of times Anomalies are Detected ####
#################################################

1/1 [==============================] - 0s 310ms/step - loss: 315.9924 - acc: 0.0909
 fraction of times anomalies are detected 0.09090909361839294
